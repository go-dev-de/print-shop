# üöÄ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ç–æ–≤–∞—Ä–æ–≤

## üìã –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã 4 —ç—Ç–∞–ø–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ç–æ–≤–∞—Ä–æ–≤:

### ‚úÖ –≠—Ç–∞–ø 1: API –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ infinite scroll
- **In-memory –∫—ç—à** —Å TTL (5 –º–∏–Ω—É—Ç –¥–ª—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤, 3 –º–∏–Ω—É—Ç—ã –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏)
- **–ù–æ–≤—ã–π API endpoint** `/api/products/paginated` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤ `src/lib/cache.js`
- **Infinite scroll** –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Ç–æ–≤–∞—Ä–æ–≤ (20 —Ç–æ–≤–∞—Ä–æ–≤ –∑–∞ —Ä–∞–∑, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞)

### ‚úÖ –≠—Ç–∞–ø 2: Database –∏–Ω–¥–µ–∫—Å—ã
- **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ö–µ–º–∞** –≤ `src/lib/ydb/schema-optimized.sql`
- **–°–∫—Ä–∏–ø—Ç –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤** `scripts/add-indexes.mjs`
- **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã** –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã `products`

### ‚úÖ –≠—Ç–∞–ø 3: Image optimization
- **Lazy loading** –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–∫—Ä–æ–º–µ –ø–µ—Ä–≤–æ–≥–æ)
- **Priority loading** –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- **Skeleton loader** –≤–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏
- **Error handling** –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **–ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞** —Å–ª–µ–¥—É—é—â–µ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

### ‚úÖ –≠—Ç–∞–ø 4: Frontend –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–•—É–∫ `useProductsCache`** –¥–ª—è —É–º–Ω–æ–≥–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- **localStorage** —Å TTL (10 –º–∏–Ω—É—Ç)
- **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏
- **–ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞** —É—Å—Ç–∞—Ä–µ–≤—à–µ–≥–æ –∫—ç—à–∞

## üöÄ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π

### 1. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
```bash
pnpm run dev
```

### 2. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ YDB (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```bash
node scripts/add-indexes.mjs
```

**‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ:** –ò–Ω–¥–µ–∫—Å—ã –º–æ–≥—É—Ç –∑–∞–Ω—è—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤ –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö.

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

#### API endpoints:
- `/api/products` - –æ—Å–Ω–æ–≤–Ω–æ–π API —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- `/api/products/paginated?page=1&limit=20&section=all` - –ø–∞–≥–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π API
- `/api/debug/cache` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ç—à–∞ (GET) –∏ –æ—á–∏—Å—Ç–∫–∞ (DELETE)

#### –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–æ–≤–∞—Ä–æ–≤:
- Infinite scroll: 20 —Ç–æ–≤–∞—Ä–æ–≤ –∑–∞ —Ä–∞–∑, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –∏ —Å–µ—Ä–≤–µ—Ä–µ
- Lazy loading –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∫—ç—à–∞ –≤–Ω–∏–∑—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏:
- **–ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å**: –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (–∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ YDB)
- **–ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã**: —É—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ **5-10 —Ä–∞–∑** (–∫—ç—à)
- **Infinite scroll**: —É—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ **3-5 —Ä–∞–∑** (–∫—ç—à + –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞)

### Database –∑–∞–ø—Ä–æ—Å—ã:
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ä–∞–∑–¥–µ–ª—É**: —É—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ **10-100 —Ä–∞–∑** (–∏–Ω–¥–µ–∫—Å—ã)
- **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–µ**: —É—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ **5-20 —Ä–∞–∑** (–∏–Ω–¥–µ–∫—Å—ã)
- **–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é**: —É—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ **3-10 —Ä–∞–∑** (–∏–Ω–¥–µ–∫—Å—ã)

### –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:
- **–ü–µ—Ä–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ**: –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
- **–û—Å—Ç–∞–ª—å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**: lazy loading
- **UX**: skeleton loader + error handling

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ö—ç—à —Å–µ—Ä–≤–µ—Ä–∞:
```javascript
// src/lib/cache.js
const defaultTTL = 5 * 60 * 1000; // 5 –º–∏–Ω—É—Ç
```

### –ö—ç—à –∫–ª–∏–µ–Ω—Ç–∞:
```javascript
// src/components/useProductsCache.js
const CACHE_TTL = 10 * 60 * 1000; // 10 –º–∏–Ω—É—Ç
```

### –ü–∞–≥–∏–Ω–∞—Ü–∏—è:
```javascript
// src/app/api/products/paginated/route.js
const limit = parseInt(searchParams.get('limit') || '20'); // 20 —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
```

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∞ —Å–µ—Ä–≤–µ—Ä–∞:
```bash
curl http://localhost:3000/api/debug/cache
```

### –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ —Å–µ—Ä–≤–µ—Ä–∞:
```bash
curl -X DELETE http://localhost:3000/api/debug/cache
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∞ –∫–ª–∏–µ–Ω—Ç–∞:
- –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞–∂–º–∏—Ç–µ "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫—ç—à–µ"
- –°–º–æ—Ç—Ä–∏—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞

### –õ–æ–≥–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:
- –°–µ—Ä–≤–µ—Ä: `üìñ Cache HIT`, `üîÑ Cache MISS`, `üíæ Cache SET`
- –ö–ª–∏–µ–Ω—Ç: `üìñ Products cache loaded`, `üíæ Products cache saved`

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ö—ç—à –≤ –ø–∞–º—è—Ç–∏** - –æ—á–∏—â–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞
2. **localStorage** - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω —Ä–∞–∑–º–µ—Ä–æ–º (–æ–±—ã—á–Ω–æ 5-10 –ú–ë)
3. **–ò–Ω–¥–µ–∫—Å—ã YDB** - —Å–æ–∑–¥–∞—é—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, –º–æ–≥—É—Ç –∑–∞–Ω—è—Ç—å –≤—Ä–µ–º—è
4. **TTL –∫—ç—à–∞** - –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ–¥ –≤–∞—à–∏ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏

## üîÆ –î–∞–ª—å–Ω–µ–π—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### –í–æ–∑–º–æ–∂–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- **Redis** –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- **CDN** –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
- **Service Worker** –¥–ª—è offline –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- **Database connection pooling**
- **Query optimization** –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
- **Lighthouse** –¥–ª—è –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **WebPageTest** –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
- **Database query profiling** –¥–ª—è YDB

---

**üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç:** –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–æ–≤–∞—Ä–æ–≤ —Ç–µ–ø–µ—Ä—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ **5-10 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ** –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ—Å–µ—â–µ–Ω–∏—è—Ö! 